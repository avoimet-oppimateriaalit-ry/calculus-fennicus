\section{Käänteisfunktio. Implisiittifunktiot} \label{käänteisfunktio}
\sectionmark{Käänteisfunktio} 
\alku
\index{funktio B!i@käänteisfunktio|vahv}
\index{kzyzy@käänteisfunktio|vahv}

Sanotaan, että reaalifunktio $f: \DF_f\kohti\R$ on 1-1 ('yksi yhteen', engl.\
one to one) eli \kor{kääntyvä} (engl.\ invertible) eli
\index{injektio}%
\kor{injektio} eli \kor{injektiivinen}, jos pätee
\[
\forall x_1, x_2 \in \DF_f\ [\,x_1 \neq x_2 \ \impl \ f(x_1) \neq f(x_2)\,].
\]
Jos $f$ on 1-1 ja $y\in \RF_f$, niin yhtälöllä
\[
f(x)=y \quad (x \in \DF_f)
\]
on y\pain{ksikäsitteinen} ratkaisu. Koska jokaiseen $y\in\RF_f$ liittyy tällä tavoin
yksikäsitteinen $x\in\DF_f$, niin kyseessä on funktioriippuvuus $y \map x$, joka
merkitään 
\[
x=f^{-1}(y).
\]
Sanotaan, että $f^{-1}$ (luetaan '$f$ miinus 1', engl.\ '$f$ inverse') on $f$:n
\kor{käänteisfunktio}. Käänteisfunktion määrittelyjoukko on siis $\DF_{\inv{f}}=\RF_f$ ja
arvojoukko $\RF_{\inv{f}}=\DF_f$.
\begin{Exa} Funktiolle $f(x)=1/x\ (\DF_f=\{x\in\R \mid x \neq 0\})$ pätee
\[
f(x_1)-f(x_2)\,=\,\frac{1}{x_1}-\frac{1}{x_2}\,=\,\frac{x_2-x_1}{x_1x_2}\,, \quad 
                                                            x_1\,,x_2 \in \DF_f\,.
\]
Tämän perusteella on $f(x_1)-f(x_2) \neq 0\,$ aina kun $x_1,x_2 \neq 0\,$ ja $x_1 \neq x_2$,
joten $f$ on 1-1. Käänteisfunktio löydetään ratkaisemalla yhtälö $f(x)=y$\,:
\[
x^{-1}=y \qimpl x=y^{-1}, \quad \text{jos}\,\ y \neq 0.
\]
Jos $y=0$, ei yhtälöllä ole ratkaisua, joten käänteisfunktion määrittelyjoukko ($=f$:n 
arvojoukko) $=\{y\in\R \mid y \neq 0\}$, ja $f^{-1}(y)=1/y$. Koska siis $\DF_{f^{-1}}=\DF_f$ ja 
$f^{-1}(y)=f(y)\ \forall y \in \DF_{f^{-1}}=\DF_f$, niin $f^{-1}=f$. \loppu
\end{Exa}

Määritelmän \ref{monotoninen funktio} nojalla on selviö, että jos funktion $f$ 
määrittelyjoukko on \pain{väli} ja $f$ on ko.\ välillä aidosti kasvava tai aidosti vähenevä
(eli aidosti monotoninen), niin $f$ on 1-1. Aito monotonisuus onkin käytännössä tavallisin
injektiivisyyden olomuoto silloin kun funktion määrittelyjoukko on väli (tai väliksi rajattu).
\begin{Exa} \label{x^m:n käänteisfunktio} Näytä, että funktio $f(x)=x^m,\ m\in\N$ on injektio,
kun määrittelyjoukko rajataan väliksi $[0,\infty)$. Määritä käänteisfunktio.
\end{Exa}
\ratk Kirjoitetaan (ks.\ Propositio \ref{kuntakaava})
\[
f(x_1)-f(x_2) \,=\, x_1^m-x_2^m \,=\, (x_1-x_2)(x_1^{m-1}+x_1^{m-2}x_2+\cdots +x_2^{m-1}).
\]
Jos tässä on $x_1\,,x_2 \ge 0$ ja $x_1 \neq x_2$, niin viimeksi kirjoitetun tulon 
jälkimmäisessä tekijässä on jokainen yhteenlaskettava ei-negatiivinen ja ainakin yksi on
positiivinen (koska joko $x_1>0$ tai $x_2>0$), joten ko.\ tekijä on positiivinen. Päätellään,
että $f$ on välillä $[0,\infty)$ aidosti kasvava:
\[
\forall x_1,x_2 \ge 0\,\ [\,x_1<x_2\ \impl\ f(x_1)<f(x_2)\,].
\]
Siis $f$ on injektio, joten yhtälöllä $f(x)=y\ (y\in\R)$ on enintään yksi ratkaisu $x$
välillä $[0,\infty)$. Jos $y<0$, ei ratkaisua ole. Jos $y=0$, on ratkaisu $x=0$. Lopulta
jos $y>0$, on ratkaisu myös olemassa ja merkitään $x=\sqrt[m]{y}$. (Luku $\sqrt[m]{y}\in\R_+$
on laskettavissa esim.\ kymmenjakoalgoritmilla, vrt.\ Luku \ref{reaaliluvut}.) Kysytty
käänteisfunktio on siis $\inv{f}(x)=\sqrt[m]{x}\,$, määrittelyjoukkona
$\DF_{\inv{f}}=\RF_f=[0,\infty)$. \loppu
\jatko \begin{Exa} (jatko) Jos $m$ on p\pain{ariton}, niin $f(x)=x^m,\ \DF_f=\R$, on pariton
ja näin muodoin aidosti kasvava koko $\R$:ssä
(ks.\ Harj.teht. \ref{yhden muuttujan funktiot}:\ref{H-IV-1: näyttöjä}b). Siis $f$ on
injektio. Yhtälöllä $f(x)=y$ on tällöin (yksikäsitteinen) ratkaisu jokaisella $y\in\R$, sillä
jos $y<0$, niin ratkaisu on $x=-\sqrt[m]{-y}$. Käänteisfunktio merkitään yleensä
yksinkertaisesti $f^{-1}(x) = \sqrt[m]{x}$, jolloin siis sovitaan, että
\[
\sqrt[m]{-x}=-\sqrt[m]{x}, \quad \text{kun $x>0$ ja $m$ on pariton}.\footnote[2]{Juurilukujen
määrittelyn laajentaminen mainitulla tavalla ei ole aivan ongelmatonta, kuten nähdään laskusta
\[
1=\sqrt[6]{1}=\sqrt[6]{(-1)^2}=(-1)^{2/6}=(-1)^{1/3}=\sqrt[3]{-1}=-1.
\]
Tämän tyyppisten ristiriitojen välttämiseksi on selvintä sopia, että reaalinen
potenssifunktio $f(x)=x^\alpha$ on määritelty välillä $(-\infty,0)$ vain kun $\alpha\in\Z$.}
\loppu \]
\end{Exa}
Seuraava yleinen sääntö on Määritelmästä \ref{monotoninen funktio} ja käänteisfunktion
määritelmästä helposti johdettavissa (Harj.teht.\,\ref{H-IV-2: todistus}a)\,:
\[
\boxed{
\begin{aligned} 
\quad\ykehys f\,\ &\text{aidosti kasvava/vähenevä välillä}\ A\subset\DF_f \\ 
                  &\qimpl \inv{f}\,\ \text{aidosti kasvava/vähenevä väleillä}\ 
                                                          B \subset f(A). \quad\akehys
\end{aligned} }
\]
\jatko \begin{Exa} (jatko) Koska $f(x)=x^m\ (m\in\N)$ on aidosti kasvava välillä
$A=[0,\infty)$, niin $\inv{f}(x)=\sqrt[m]{x}$ on samoin aidosti kasvava välillä
$[0,\infty)=f(A)$. \loppu
\end{Exa}
Käänteisfunktion määritelmästä helposti todennettavissa ovat myös yleiset funktioalgebran lait
\[
\boxed{ \begin{aligned}
\ykehys\quad(\inv{f} \circ f)(x) &= x \quad \forall x\in \DF_f, \quad\\
            (f \circ \inv{f})(y) &= y \quad \forall y\in \RF_f, \\
                 \inv{(\inv{f})} &= f. \akehys
\end{aligned} }
\]
Käänteisfunktion $\inv{f}$ kuvaaja saadaan vaihtamalla $x$ ja $y$ $f$:n kuvaajassa, eli 
peilaamalla $f$:n kuvaaja suoran $y=x$ suhteen. Kuvassa $f(x)=x^2,\ \DF_f = [0,\infty)$.
\begin{figure}[H]
\setlength{\unitlength}{1cm}
\begin{center}
\begin{picture}(7,6.5)(-1,-1.5)
\put(0,0){\vector(1,0){6}} \put(5.8,-0.4){$x$}
\put(0,-1.5){\vector(0,1){6.5}} \put(0.2,4.8){$y$}
\multiput(1,0)(1,0){2}{\drawline(0,-0.1)(0,0.1)}
\multiput(0,1)(0,1){2}{\drawline(-0.1,0)(0.1,0)}
\put(0.9,-0.5){$1$} \put(1.9,-0.5){$2$}
\put(-0.5,-0.15){$0$} \put(-0.5,0.9){$1$} \put(-0.5,1.9){$2$}
\curve(0,0,1,1,2,4) \put(1.5,4.2){$y=f(x)$}
\curve(0,0,1,1,4,2) \put(4.3,2){$y=\inv{f}(x)$}
\dashline{1}(0,0)(4,4) \put(4,4.2){$y=x$}
\end{picture}
%\caption{Käänteisfunktion $\inv{f}$ kuvaaja, kun $f(x)=x^2$}
\end{center}
\end{figure}
\begin{Exa} \label{algebrallinen käänteisfunktio} Tutki funktion $f(x)=x^5+3x,\ \DF_f=\R$ 
(mahdollista) käänteisfunktiota. \end{Exa}
\ratk Koska $f$ on pariton ja 
\[
f(x_1)-f(x_2)=(x_1-x_2)(x_1^4+x_1^3x_2+x_1^2x_2^2+x_1x_2^3+x_2^4+3),
\]
niin päätellän kuten Esimerkissä \ref{x^m:n käänteisfunktio}, että $f$ on aidosti 
kasvava koko $\R$:ssä. Käänteisfunktio $\inv{f}: \RF_f \kohti \R$ on siis olemassa. Kun
$y \in \RF_f$, niin funktioevaluaatio $y \map x = \inv{f}(y)$ tarkoittaa yhtälön
\[
x^5+3x=y
\]
ratkaisemista. Ratkeavuus jokaisella $y>0$ on osoitettavissa
(Harj.teht.\,\ref{H-IV-2: ratkeavuus kymmenjaolla}), ja koska $f$ on pariton, niin yhtälö
ratkeaa myös jokaisella $y \le 0$, t.s.\ $\RF_f=\DF_{\inv{f}}=\R$. Nähdään myös, että 
esimerkiksi $\inv{f}(0)=0$, $\inv{f}(4)=1$, ja $\inv{f}(-38)=-2$. Sen sijaan vaikkapa lukua
$a=\inv{f}(1)$ ei voi määrätä 'tarkasti' edes juurilukujen avulla, vaan kyseessä on yleisempi
(algebrallinen, vrt.\ Luku \ref{reaalilukujen ominaisuuksia}) luku. Tällaisen luvun
määrittelyssä on tyydyttävä reaaliluvun yleiseen määritelmään, esim.\ äärettömänä
desimaalilukuna (ks.\ Harj.teht.\,\ref{H-IV-2: ratkeavuus kymmenjaolla}). Symbolinen laskenta
luvulla $a$ on toki myös mahdollista, mutta tällainen laskenta määritelmän $a^5 + 3a = 1$
perusteella on varsin rajoitettua. --- Laihan lohdun suokoon tulos
\[
\inv{a}=a^4+3. \loppu
\]

\subsection*{Injektio, surjektio ja bijektio}
\index{injektio|vahv} \index{surjektio|vahv} \index{bijektio|vahv}

Kuten Esimerkissä \ref{x^m:n käänteisfunktio} edellä, on käänteisfunktioita tutkittaessa varsin 
tavallista, että $f$ ei välttämättä ole injektiivinen koko määrittelyjoukossaan, mutta on 
kuitenkin injektio, jos määrittelyjoukkoa sopivasti rajoitetaan. Käänteisfunktiotarkastelujen 
lähtökohdaksi voidaan tällöin ottaa rajoitettu kuvaus
\[
f:A\rightarrow B,
\]
missä $A\subset D_f$ ja $B \supset f(A)$. Yleensä $A$ on $D_f$:n jokin \pain{osaväli}. Joukkoon
$A$ rajattua funktiota voidaan haluttaessa merkitä $f_{|A}$ ja sanoa, että kyseessä on 
\index{rajoittuma (funktion)}%
\kor{f:n rajoittuma $A$:lle}. Jos tässä $B$ on vielä onnistuttu valitsemaan siten, että
$B=f(A)$, niin sanotaan, että $f:A \kohti B$ on \kor{surjektio B:lle} (ransk. sur jeter = 
heittää päälle; englanninkielinen 'f onto B' sisältää saman ajatuksen). Termiä käytetään myös
silloin kun $f$ ei ole injektio. Siis funktiosta $f: A \kohti B$ saadaan surjektio
yksinkertaisesti rajaamalla maalijoukko $f(A)$:ksi. Jos $f:A \kohti B$ ($=f_{|A}$) on sekä
injektio että surjektio, niin sanotaan, että $f:A \kohti B$ on \kor{bijektio} (engl. one to one
and onto). Tällöin myös käänteisfunktio $\inv{f}:B \kohti A$ (tässä siis 
$\inv{f} = (f_{|A})^{-1}$) on bijektio.\footnote[2]{Termit injektio, surjektio ja bijektio eivät
rajoitu reaalifunktioihin, vaan ne voidaan liittää yhtä hyvin yleiseen joukko-opilliseen
funktiokäsitteeseen (ks.\ Luku \ref{trigonometriset funktiot}). Jos $A$ ja $B$ ovat joukkoja,
ja on olemassa bijektio $f:A \kohti B$, niin sanotaan, että $A$:n ja $B$:n välillä on
(bijektion $f$ luoma) \kor{kääntäen yksikäsitteinen vastaavuus} ja merkitään $A \vast B$.
Esim.\ Luvun \ref{tasonvektorit} merkinnässä $\Ekaksi\vast\Rkaksi$ tarkoitetaan tällaista
vastaavuutta annetussa tason koordinaatistossa.
\index{vastaavuus ($\ensuremath  {\leftrightarrow }$)|av}} 
\begin{Exa} Jos $f(x)=x^m$, niin $f:\,[0,\infty)\kohti[0,\infty)$ on bijektio jokaisella
$m\in\N$, samoin esim.\ $f:\,(0,\infty)\kohti(0,\infty)$, $f:\,[0,1]\kohti[0,1]$ ja
$f:\,[1,\infty)\kohti[1,\infty)$ (vrt.\ Esimerkki \ref{x^m:n käänteisfunktio}). \loppu
\end{Exa} 
\begin{Exa} Jos $f(x)=x^2$, niin \vspace{2mm}\newline
$f:\ [-2,3]\kohti[0,10]\ \ $     on funktio, mutta ei injektio eikä surjektio. \newline
$f:\ [-2,3]\kohti[0,9]\quad\,$   on surjektio, ei injektio. \newline
$f:\ [0,3]\kohti[0,10]\quad\,\ $ on injektio, ei surjektio: käänteisfunktio
     $f^{-1}(x)=\sqrt{x}$. 
\newline
$f:\ [0,3]\kohti[0,9]\qquad$     on bijektio: käänteisfunktio $f^{-1}(x)=\sqrt{x}$. \newline
$f:\ [-2,-1]\kohti[1,4]\,\ $     on bijektio: käänteisfunktio $f^{-1}(x)=-\sqrt{x}$. \loppu
\end{Exa}

\subsection*{Trigonometriset käänteisfunktiot}
\index{funktio C!d@$\Arcsin$, $\Arccos$, $\Arctan$, $\Arccot$|vahv}

Trigonometriset funktiot eivät ole injektiivisiä koko määrittelyjoukossaan, joten ne eivät ole 
'kääntyviä' tavallisessa mielessä. Trigonometrisilla käänteisfunktioilla tarkoitetaankin 
tavallisimmin funktioita, jotka saadaan rajoittamalla trigonometrinen funktio joko välille 
$[-\frac{\pi}{2},\frac{\pi}{2}]$ tai $(-\frac{\pi}{2},\frac{\pi}{2})$ ($\sin$, $\tan$) tai 
välille $[0,\pi]$ tai $(0,\pi)$ ($\cos$, $\cot$), jolloin funktio on ko. välillä aidosti 
monotoninen. Näin saatuja käänteisfunktioita sanotaan
\index{arkusfunktiot} \index{syklometriset funktiot}%
\kor{arkusfunktioiksi} tai \kor{syklometrisiksi funktioiksi}. Määritelmät ovat
\begin{alignat*}{2}
x&=\sin y\ \ \ja \ &y \in \left[-\tfrac{\pi}{2},\tfrac{\pi}{2}\right] \ & \ekv\ y=\Arcsin x, \\
x&=\cos y\,\ \ja \ &y \in \left[0,\pi\right]\quad\ \ & \ekv \ y=\Arccos x, \\
x&=\tan y \ \ja \ &y \in \left(-\tfrac{\pi}{2},\tfrac{\pi}{2}\right) \ & \ekv\ y=\Arctan x, \\
x&=\cot y\,\ \ja \ &y \in \left(0,\pi\right)\quad\ & \ekv \ y=\Arccot x.
\end{alignat*}
Nämä luetaan 'arkus sini' jne. Kyseessä ovat trigonometristen käänteisfunktioiden nk.\
\index{pzyzy@päähaara (funktion)}%
\kor{päähaarat}.\footnote[2]{ Muille väleille rajoitettujen trigonometristen funktioiden 
käänteisfunktioista käytetään tässä tekstissä yhteismerkintää $\arcsin$, jne. --- ks.\ tarkempi
määrittely luvun lopussa. Kirjallisuudessa trigonometristen käänteisfunktioiden merkintätavat
ovat hieman kirjavat. Vanhempia päähaarojen merkintöjä ovat $\overline{\text{arc}}$sin, 
$\overline{\text{arc}}$cos, $\overline{\text{arc}}$tan, $\overline{\text{arc}}$cot. Laskimissa
tavallisia merkintöjä $\,\sin^{-1}$, $\,\cos^{-1}$ ja $\,\tan^{-1}$ näkee myös käytettävän 
kirjallisuudessa. --- Tässä tekstissä määritellään $\,\sin^n x=(\sin x)^n\ \forall n\in\Z$,
jolloin $\sin^{-1}x=1/\sin x$.}

Arkusfunktioiden määrittely- ja arvojoukot ovat määritelmien perusteella seuraavat:
\[
\begin{array}{llll}
\Arcsin x &: \quad & \DF_f=[-1,1], \quad & \RF_f=[-\tfrac{\pi}{2},\tfrac{\pi}{2}]. \\
\Arccos x &: \quad & \DF_f=[-1,1], \quad & \RF_f=[0,\pi]. \\
\Arctan x &: \quad & \DF_f=\R, \quad     & \RF_f=(-\tfrac{\pi}{2},\tfrac{\pi}{2}). \\
\Arccot x &: \quad & \DF_f=\R, \quad     & \RF_f=(0,\pi).
\end{array}
\]
Funktiot $\Arcsin$ ja $\Arctan$ ovat määrittelyvälillään aidosti kasvavia (kuten $\sin$ ja
$\tan$), muut kaksi aidosti väheneviä.
\begin{figure}[H]
\setlength{\unitlength}{1.3cm}
\begin{picture}(5,5.4)(-2.2,-2.7)
\put(-2,0){\vector(1,0){4}} \put(2.2,-0.1){$x$}
\put(0,-2){\vector(0,1){4.4292}} \put(0,2.6292){$y$}
\put(-0.9,-2.6){$y=\Arcsin x$}
\put(-1,0){\line(0,1){0.07}} \put(1,0){\line(0,1){0.07}}
\put(0,-1.5708){\line(1,0){0.07}} \put(0,1.5708){\line(1,0){0.07}}
\put(-1.3,-0.4){$-1$} \put(0.95,-0.4){$1$}
\put(0.15,-1.66){$-\tfrac{\pi}{2}$} \put(0.25,1.5){$\tfrac{\pi}{2}$}
\curve(
-1.0000,  -1.5708,
-0.8776,  -1.0708,
-0.5403,  -0.5708,
-0.0707,  -0.0708,
 0.0707,   0.0708,
 0.5403,   0.5708,
 0.8776,   1.0708,
 1.0000,   1.5708)
\put(4,-1.5708){\vector(1,0){4}} \put(8.2,-1.6708){$x$}
\put(6,-1.5708){\vector(0,1){4}} \put(6,2.6292){$y$}
\put(5,-1.5708){\line(0,1){0.07}} \put(7,-1.5708){\line(0,1){0.07}}
\put(6,0){\line(1,0){0.07}} \put(6,1.5708){\line(1,0){0.07}}
\put(4.7,-1.9708){$-1$} \put(6.95,-1.9708){$1$}
\put(6.25,-0.0708){$\tfrac{\pi}{2}$} \put(6.25,1.5292){$\pi$}
\put(5.1,-2.6){$y=\Arccos x$}
\curve(
 5.0000,   1.5708,
 5.0200,   1.3705,
 5.0500,   1.2532,
 5.1000,   1.1198,
 5.1500,   1.0160,
 5.4000,   0.6435,
 5.7000,   0.3047,
 6.0000,   0.0000,
 6.3000,  -0.3047,
 6.6000,  -0.6435,
 6.8500,  -1.0160,
 6.9000,  -1.1198, 
 6.9500,  -1.2532,
 6.9800,  -1.3705,
 7.0000,  -1.5708)
\end{picture} 
\end{figure}

\begin{figure}[H]
\setlength{\unitlength}{1cm}
\begin{picture}(15,4.5)(-2.2,-2)
\put(-1,0){\vector(1,0){12}} \put(11.2,-0.1){$x$}
\put(5,-2){\vector(0,1){4}} \put(5,2.2){$y$}
\put(7.5,1.6){$y=\Arctan x$}
\put(4,0){\line(0,1){0.1}} \put(6,0){\line(0,1){0.1}}
\put(5,-1.5708){\line(1,0){0.1}} \put(5,1.5708){\line(1,0){0.1}}
\put(3.7,-0.4){$-1$} \put(5.95,-0.4){$1$}
\put(5.15,-1.66){$-\tfrac{\pi}{2}$} \put(5.25,1.5){$\tfrac{\pi}{2}$}
\curve(
-0.5000,  -1.3909,
 1.0000,  -1.3258,
 2.0000,  -1.2491,
 3.0000,  -1.1072,
 3.5000,  -0.9828,
 4.0000,  -0.7854,
 4.3000,  -0.6107,
 4.6000,  -0.3805,
 4.8000,  -0.1974,
 5.0000,   0.0000,
 5.2000,   0.1974,
 5.4000,   0.3805,
 5.7000,   0.6107,
 6.0000,   0.7854,
 6.5000,   0.9828,
 7.0000,   1.1072,
 8.0000,   1.2491,
 9.0000,   1.3258,
10.5000,   1.3909) 
\end{picture} 
\end{figure}

Funktiopareista $\,(\Arcsin,\,\Arccos)\,$ ja $\,(\Arctan,\,\Arccot)\,$ riittää sovelluskäyttöön
valita yksi edustaja kummastakin parista (tavallisimmin valitaan $\Arcsin$ ja $\Arctan$), sillä
parien 'jäsentenvälinen' ratkeaa yksinkertaisiin yhteyksiin
\[ 
\boxed{ \begin{aligned}
\ykehys\quad \Arcsin x + \Arccos x &= \frac{\pi}{2} \quad \forall x\in [-1,1], \quad \\
\akehys\quad \Arctan x + \Arccot x &= \frac{\pi}{2} \quad \forall x\in\R.
\end{aligned} }
\]  
Näistä esimerkiksi ensimmäinen seuraa päättelyllä (vrt.\ kuviot edellä)
\begin{align*}
&\begin{cases}
\,\dfrac{\pi}{2}-\Arccos x \in \left[-\dfrac{\pi}{2},\dfrac{\pi}{2}\right] \quad 
                           &\forall x\in[-1,1] \\[2mm]
\,\sin\left(\dfrac{\pi}{2} - \Arccos x\right) = \cos (\Arccos x) = x \quad 
                           &\forall x\in[-1,1]
\end{cases} \\
&\qimpl \frac{\pi}{2}- \Arccos x =\Arcsin x \quad \forall x\in[-1,1].
\end{align*}
\begin{Exa} Hahmottele funktion $\Arcsin(\cos x)$ kuvaaja. \end{Exa}
\ratk Sievennetään ensin $\,y=\Arcsin(\cos x)$\,:
\begin{align*}
y&\,=\,\Arcsin (\cos x) \\[1mm]
 &\,\ekv\ \ y \in \left[-\frac{\pi}{2},\frac{\pi}{2}\right] \ \ja \ \sin y = \cos x \\
 &\,\ekv\ \ y \in \left[-\frac{\pi}{2},\frac{\pi}{2}\right] \ \ja \ 
                                             \sin y = \sin \left(\frac{\pi}{2} -x\right) \\
 &\,\ekv\ \ y \in \left[-\frac{\pi}{2},\frac{\pi}{2}\right] \ \ja \ 
                                    y = \frac{\pi}{2} \pm x + n \cdot 2\pi, \ n\in\Z.
\end{align*}
Tämän perusteella kuvaaja koostuu joukosta suoria rajoitettuna välille 
$y\in[-\tfrac{\pi}{2},\tfrac{\pi}{2}]$ (ks.\ kuvio). \loppu
\begin{figure}[H]
\begin{center}
\setlength{\unitlength}{1cm}
\begin{picture}(14,5.5)(-7,-2)
\put(-7,0){\vector(1,0){14}} \put(6.8,-0.4){$x$}
\put(0,-2.5){\vector(0,1){6}}  \put(0.2,3.3){$y$}
\drawline(-6.8,1.05)(-6.28,1.57)(-3.14,-1.57)(0,1.57)(3.14,-1.57)(6.28,1.57)(6.8,1.05)
\multiput(-1.57,0)(3.14,0){2}{\drawline(0,-0.1)(0,0.1)}
\put(-2,-0.6){$-\tfrac{\pi}{2}$} \put(1.45,-0.6){$\tfrac{\pi}{2}$} 
\put(-0.7,1.4){$\tfrac{\pi}{2}$}
\put(-5.5,1.5){\vector(0,-1){0.5} $n=-1$ $(-)$} \put(-2.5,-1.5){\vector(0,1){0.5} $n=0$ $(+)$} 
\put(0.8,1.5){\vector(0,-1){0.5} $n=0$ $(-)$} \put(3.8,-1.5){\vector(0,1){0.5} $n=-1$ $(+)$}
\end{picture}
\end{center}
\end{figure}

\subsection*{Implisiittifunktio $y(x)$}
\index{funktio B!j@implisiittifunktio|vahv}
\index{implisiittifunktio|vahv}

Jos yhtälöstä muotoa
\[
F(x,y)=0
\]
on $y$ ratkaistavissa yksikäsitteisesti jokaisella $x \in A$ ($A\subset\R$), niin
sanotaan, että yhtälö määrittelee $A$:ssa \kor{implisiittifunktion} $y=f(x)$. Termillä
tarkoitetaan, että funktio on määritelty epäsuorasti eli \kor{implisiittisesti}. Tällöin
\pain{ei} edellytetä, että funktio on kirjoitettavissa suoraan (eli eksplisiittisesti)
tunnettuna lausekkeena. Yhtälössä $F$ on kahden reaalimuuttujan reaaliarvoinen funktio --- 
käytännössä lauseke, jossa $x$ ja $y$ esiintyvät. (Kahden muuttujan funktioita itsenäisinä
olioina käsitellään seuraavassa luvussa.)

Implisiittifunktiota merkittäessä halutaan usein säilyttää 'paikan tuntu' käyttämällä
yleismerkinnän $f(x)$ sijasta merkintää $y(x)$. Tämän mukaisesti siis funktioriippuvuus
$x \map y(x)$ määritellään epäsuoralla laskusäännöllä
\[
F(x,y(x))=0, \quad x \in A.
\]
Yksinkertainen esimerkki implisiittifunktiosta on käänteisfunktio, sillä jos
käänteisfunktion määrittelyssä vaihdetaan $x$ ja $y$, niin määritelmä on
\[
F(x,y)=x-f(y)=0,\,\ y\in\DF_f \qekv y(x)=\inv{f}(x).
\]
--- Itse asiassa myös tavallinen funktio muuttuu 'implisiittiseksi', kun $y=f(x)$ 
kirjoitetaan muotoon $F(x,y)=f(x)-y=0$.
\begin{Exa} Jos $b \neq 0$, niin tason suoran perusmuotoinen yhtälö
\[
ax+by+c=0
\]
voidaan tulkita implisiittifunktion $y(x)=-(ax+c)/b$ määrittelyksi. \loppu
\end{Exa} 
\begin{Exa} \label{muuan implisiittifunktio} Tarkasteltaessa yhtälöä
\[
F(x,y)=x+y+\cos x\sin y=0
\]
osoittautuu (tarkemmat perustelut sivuutetaan), että yhtälöllä on yksikäsitteinen ratkaisu
$y(x)$ jokaisella $x\in\R$, t.s.\ yhtälö määrittelee koko $\R$:ssä implisiittifunktion $y(x)$.
Yhtälöstä on pääteltävissä, että $y(x)=-x$ kun $x=(n+\tfrac{1}{2})\pi$ ja samoin kun
$x=n\pi$, $\,n\in\Z$. Muilla $x$:n arvoilla funktioevaluaatio $x \map y(x)$ on työläämpi, sillä
kyseessä on nk.\ 
\index{transkendenttinen yhtälö}%
\kor{transkendenttinen yhtälö}, joka ratkeaa vain numeerisin keinoin.
Yhtälöstä on myös $x$ ratkaistavissa yksikäsitteisesti jokaisella $y\in\R$. Näin määräytyy
(joskaan ei lausekkeena) funktio $y \map x(y)$, joka on funktion $x \map y(x)$ käänteisfunktio.
\loppu \end{Exa}

\subsection*{Monihaaraiset implisiittifunktiot}
\index{funktio B!j@implisiittifunktio|vahv}
\index{implisiittifunktio|vahv}
\index{monihaarainen implisiittifunktio|vahv}

Implisiittifunktion määrittely-yrityksissä varsin tavallinen on tilanne, että yhtälö $F(x,y)=0$
ratkeaa $y$:n suhteen annetulla $x$, mutta ei yksikäsitteisesti. Olkoon tällaisessa tilanteessa
$A\subset\R$ väli (suljettu, avoin tai puoliavoin) ja tarkastellaan yhtälöä, kun $x \in A$.
Oletetetaan, että on olemassa välille $A$ ominainen indeksijoukko $\Lambda\subset\N$ 
(voi olla myös $\Lambda=\N$) ja funktioj\pain{oukko}
%S_i=\{P \vastaa (x,y) \in \R^2 \mid x \in A \ \ja \ y=f_i(x)\},
\[
\mathcal{Y}=\{y_i, \ i \in \Lambda \}
\]
siten, että pätee
\[
\forall x \in A\ [\,F(x,y)=0\ \ekv\ y\in\{y_i(x),\ i\in\Lambda\}\,].
\]
Sanotaan tällöin, että $\mathcal{Y}$ on yhtälön $F(x,y)=0$ välillä $A$ määrittelemä 
\kor{monihaarainen} (moniarvoinen) \kor{implisiittifunktio}. Monihaarainen implisiittifunktio
ei siis ole funktio vaan sellaisten joukko. Joukon $\mathcal{Y}$ alkioita $y_i$ sanotaan
\index{haara (funktion)}%
$\mathcal{Y}$:n \kor{haaroiksi} (engl. branch).\footnote[2]{Monihaarainen funktio $\mathcal{Y}$
voidaan myös tulkita \kor{joukkoarvoiseksi} määrittelemällä
\[ 
\mathcal{Y}(x) = \{y_i(x),\ i \in \Lambda\},
\]
missä $y_i,\ i \in \Lambda$ ovat $\mathcal{Y}$:n haarat tarkasteltavalla välillä $A$. Koska
$\mathcal{Y}(x)$ on (joukkona) yksikäsitteinen jokaisella $x \in A$, niin $\mathcal{Y}$ on
funktio tyyppiä $\mathcal{Y}: A \kohti \mathcal{B}$, missä maalijoukko $\mathcal{B}$ on
'joukkojen joukko' 
$\mathcal{B} = \{\,\{t_i, \ i \in \Lambda\} \mid t_i \in \R\ \ \forall i \in \Lambda\,\}$.
\index{joukkoarvoinen (funktio)|av}} 
Kuviossa haaroja on kolme välillä $A=[a,b]$.\footnote[3]{Jotta monihaaraisen funktion 
$\mathcal{Y}=\{y_i\}$ haarat $y_i$ olisivat yksiselitteiset, on määrittelyssä estettävä 
'hyppiminen haaralta toiselle'. Ehdon voi tulkita geometris--intuitiivisesti niin, että
kuvaajien $G_i=\{P=(x,y)\in\Ekaksi \mid y=y_i(x)\ \ja\ x \in A\}$ on oltava \kor{yhtenäisiä}
tason pistejoukkoja, ts.\ kuvaajissa ei sallita 'katkoksia'. (Täsmällisemmin tarkoitetaan,
että funktioiden $y_i$ on oltava \kor{jatkuvia}, ks.\ Luku \ref{jatkuvuuden käsite}
jäljempänä.)}
\begin{figure}[H]
\begin{center}
\setlength{\unitlength}{1cm}
\begin{picture}(8,7.5)(-1,-2)
\put(-1,0){\vector(1,0){10}}\put(8.8,-0.4){$x$}
\put(0,-2){\vector(0,1){7.5}}\put(0.2,5.3){$y$}
\put(1,0){\drawline(0,-0.1)(0,0.1)} \put(6,0){\drawline(0,-0.1)(0,0.1)}
\put(0.9,-0.5){$a$} \put(5.9,-0.5){$b$}
\put(0,-0.4){\curve(
    1.0000,   -1.1137,
    1.2000,   -1.1013,
    1.4000,   -1.0586,
    1.6000,   -0.9883,
    1.8000,   -0.9004,
    2.0000,   -0.8108,
    2.2000,   -0.7383,
    2.4000,   -0.7012,
    2.6000,   -0.7129,
    2.8000,   -0.7791,
    3.0000,   -0.8952,
    3.2000,   -1.0466,
    3.4000,   -1.2100,
    3.6000,   -1.3572,
    3.8000,   -1.4598,
    4.0000,   -1.4947,
    4.2000,   -1.4487,
    4.4000,   -1.3217,
    4.6000,   -1.1282,
    4.8000,   -0.8954,
    5.0000,   -0.6600,
    5.2000,   -0.4619,
    5.4000,   -0.3379,
    5.6000,   -0.3146,
    5.8000,   -0.4034,
    6.0000,   -0.5976)}
\put(0,-0.747){\curve(
    1.0000,    3.0000,
    1.2000,    2.8198,
    1.4000,    2.6562,
    1.6000,    2.5080,
    1.8000,    2.3740,
    2.0000,    2.2531,
    2.2000,    2.1440,
    2.4000,    2.0456,
    2.6000,    1.9566,
    2.8000,    1.8760,
    3.0000,    1.8025,
    3.2000,    1.7349,
    3.4000,    1.6720,
    3.6000,    1.6127,
    3.8000,    1.5558,
    4.0000,    1.5000,
    4.2000,    1.4442,
    4.4000,    1.3873,
    4.6000,    1.3280,
    4.8000,    1.2651,
    5.0000,    1.1975,
    5.2000,    1.1240,
    5.4000,    1.0434,
    5.6000,    0.9544,
    5.8000,    0.8560,
    6.0000,    0.7469)}
\put(0,-1.3){\curve(
    1.0000,    4.0000,
    1.2000,    5.1424,
    1.4000,    5.8307,
    1.6000,    6.1511,
    1.8000,    6.1831,
    2.0000,    5.9988,
    2.2000,    5.6630,
    2.4000,    5.2337,
    2.6000,    4.7614,
    2.8000,    4.2895,
    3.0000,    3.8545,
    3.2000,    3.4854,
    3.4000,    3.2042,
    3.6000,    3.0256,
    3.8000,    2.9574,
    4.0000,    3.0000,
    4.2000,    3.1467,
    4.4000,    3.3836,
    4.6000,    3.6898,
    4.8000,    4.0369,
    5.0000,    4.3898,
    5.2000,    4.7058,
    5.4000,    4.9352,
    5.6000,    5.0213,
    5.8000,    4.8999,
    6.0000,    4.5000)}
\put(6,-1.4){$y=y_1(x)$}
\put(6,0.5){$y=y_2(x)$}
\put(6,3.7){$y=y_3(x)$}
\end{picture}
%\caption{Monihaarainen implisiittifunktio}
\end{center}
\end{figure}

\begin{Exa}
Yhtälö $\,x^2+y^2=1\,$ määrittelee välillä $[-1,1]$ kaksihaaraisen implisiittifunktion
$\mathcal{Y}=\{y_+,y_-\}$, missä $y_\pm = \pm \sqrt{1-x^2}$. \loppu
\end{Exa}
\begin{Exa} Millaisen monihaaraisen implisiittifunktion määrittelee yhtälö \newline
$y^4-2y^2+x^2-x=0\,$ eri $\R$:n osaväleillä?
\end{Exa}
\ratk Jos $x\in\R$, niin yhtälön mahdolliset ratkaisut $y\in\R$ ovat
\[
y=\pm\sqrt{1\pm\sqrt{1+x-x^2}}.
\]
Tässä on
\begin{align*}
1+x-x^2 &\ge 0 \qekv \frac{1}{2}(1-\sqrt{5}) \le x \le \frac{1}{2}(1+\sqrt{5}), \\
1+x-x^2 &\ge 1 \qekv 0 \le x \le 1.
\end{align*}

Päätellään, että välillä $[0,1]$ funktio on kaksihaarainen: $\mathcal{Y}=\{y_1\,,\,y_2\}$,
missä
\[
y_1(x)=\sqrt{1+\sqrt{1+x-x^2}}\,, \quad y_2(x)=-\sqrt{1+\sqrt{1+x-x^2}}\,.
\]
Väleillä $\,[\tfrac{1}{2}(1-\sqrt{5}),\,0]\,$ ja $\,[1,\,\tfrac{1}{2}(1+\sqrt{5})]\,$ on
$0 \le 1+x-x^2 \le 1$, joten näillä väleillä funktio on nelihaarainen: 
$\mathcal{Y}=\{y_1\,,\,y_2\,,\,y_3\,,\,y_4\}$, missä $y_1$ ja $y_2$ ovat samat kuin edellä ja
\[
y_3(x)=\sqrt{1-\sqrt{1+x-x^2}}\,, \quad  y_4(x)=-\sqrt{1-\sqrt{1+x-x^2}}\,.
\]
Jos $x\in(-\infty,\,\tfrac{1}{2}(1-\sqrt{5}))$ tai $x\in(\tfrac{1}{2}(1+\sqrt{5}),\,\infty)$,
ei yhtälö toteudu millään $y\in\R$, joten näillä väleillä yhtälö ei määrittele mitään
(reaali)funktiota. \loppu 

\subsection*{Funktiot $\arcsin$, $\arccos$, $\arctan$}
\index{funktio C!e@$\arcsin$, $\arccos$, $\arctan$|vahv}

Funktiomerkinnöillä $\,\arcsin$, $\arccos$ ja $\arctan$ tarkoitetaan yhtälöiden $x-\sin y =0$,
$x-\cos y=0$ ja $x-\tan y=0$ määrittelemiä äärettömän monihaaraisia funktioita,
määrittelyjoukkona joko väli $[-1,1]$ ($\arcsin,\,\arccos$) tai $\R$ ($\arctan$). Esimerkiksi
$\arctan$  määritellään
\[
\arctan = \{y_n, \ n\in\Z\},
\]
missä
\[
y_n(x)= \Arctan x + n\pi.
\]
Tässä $y_0(x)=\Arctan x\,$ on $\,\arctan$:n
\index{pzyzy@päähaara (funktion)}%
\kor{päähaara} (engl.\ principal branch).
\begin{Exa} \label{napakulman kaava} Jos $\varphi(x,y)$ on karteesisen koordinaatiston
pistettä $(x,y)$ vastaava napakulma, $\varphi\in[0,2\pi)$, niin funktioriippuvuus 
$(x,y)\map\varphi(x,y)$ on
\[
\varphi(x,y)=
\begin{cases}
\Arctan(y/x),      &\text{jos}\ \ x>0\ \ja\ y\geq 0, \\
\Arctan(y/x)+\pi,  &\text{jos}\ \ x<0, \\
\Arctan(y/x)+2\pi, &\text{jos}\ \ x>0\ \ja\ y<0, \\
\pi/2,             &\text{jos}\ \ x=0\ \ja\ y>0, \\
3\pi/2,            &\text{jos}\ \ x=0\ \ja\ y<0.
\end{cases}
\]
Tässä tarvittiin siis peräti kolmea $\arctan$:n haaraa (!).
\loppu
\begin{figure}[H]
\begin{center}
\input{plots/arctanhaarat.tex}
\end{center}
\end{figure}
\end{Exa}

\Harj
\begin{enumerate}

\item \label{H-IV-2: todistus}
Todista: a) Jos $f$ on välillä $A\subset\DF_f$ aidosti kasvava tai vähenevä, niin samoin
on $f^{-1}$ väleillä $B \subset f(A)$.\, b) Jos $f$ on 1-1 ja pariton, niin samoin on
$\inv{f}$.

\item
a) Funktio $f(x)=x^2+x+2$ on kääntyvä, kun se rajoitetaan välille $(-\infty,a]$ tai välille
$[a,\infty)$. Määritä $a$ ja käänteisfunktio kummallakin välillä. \vspace{1mm}\newline
b) Näytä algebran keinoin, että funktio $f(x)=x^3+2x$ on koko määrittelyjoukossaan ($=\R$)
aidosti kasvava. Määritä $f^{-1}(-1)$, $f^{-1}(3)$, $f^{-1}(10)$, $f^{-1}(12)$ ja 
$f^{-1}(4\sqrt{2})$ tarkasti, jos mahdollista, muuten likimäärin yhden desimaalin
tarkkuudella. \vspace{1mm}\newline
c) Olkoon $f(x)=(1-x^n)^{1/n},\,\ \DF_f=[0,1],\ n\in\N$. Näytä, että $f=\inv{f}$.
\vspace{1mm}\newline
d) Olkoon $f(x)=(ax+b)/(cx+d)$. Millä vakioiden $a,b,c,d$ arvoilla on $f=\inv{f}$\,?

\item
Tarkastellaan funktioita $f: A \kohti R$. Määritä seuraavissa tapauksissa $B$ siten, että
$f: A \kohti B$ on surjektio. Onko $f: A \kohti B$ tällöin myös bijektio? \vspace{1mm}\newline
a) \ $f(x)=-x^5,\ A=(-4,-3]$ \newline
b) \ $f(x)=x^2,\ A=[\sqrt{2}-\sqrt{3}\,,\sqrt{2}+\sqrt{3}\,]$ \newline
c) \ $f(x)=-6x-x^2,\ A=(-5,-2)$ \newline
d) \ $f(x)=(x+5)/(x+2),\ A=[-1,1]$ \newline
e) \ $f(x)=3+2\sin x,\ A=[3\pi/2,11\pi/6]$ \newline
f) \ $f(x)=x+\Arcsin x,\ A=[-1,1]$

\item
Laske tarkka arvo lausekkeelle tai ratkaise yhtälö:
\begin{align*}
&\text{a)}\ \sin\left(\Arccos\left(-\frac{3}{5}\right)\right) \qquad\quad\ \
 \text{b)}\ \cos\left(\Arcsin\left(-\frac{3}{5}\right)\right) \\
&\text{c)}\ \sin\left(\Arctan\left(-\sqrt{3}\right)\right) \qquad\quad\,\
 \text{d)}\ \sin\left(\Arccot\left(-\sqrt{3}\right)\right) \\
&\text{e)}\ \sin\left(\Arctan 2-\Arctan 3\right) \quad\ \ \
 \text{f)}\ \cos\left(\Arccot\frac{2}{5}+\Arctan\frac{3}{7}\right) \\
&\text{g)} \,\ \Arctan x=\frac{\pi}{4}-\Arctan 3 \quad\,\ \
 \text{h)} \,\ \Arccos x=\Arctan 2+\Arccos\frac{3}{4}
\end{align*}

\item
Saata seuraavat funktiot muotoon $R\sin(x+\alpha)$:
\begin{align*}
&\text{a)}\ \ f(x)=\sin x+\sin\left(x-\Arctan\frac{4}{3}\right) \\
&\text{b)}\ \ f(x)=\sqrt{5}\sin\left(x+\Arctan\frac{1}{2}\right)
                +2\sqrt{2}\sin\left(x+\frac{3\pi}{4}\right)+\sqrt{3}\sin(x-\pi)
\end{align*}

\item
Määritä $R$ ja $\alpha$ siten, että
\[
2\sin\left(x+\Arctan 2\sqrt{2}\right)+R\sin(x+\alpha)=6\sin x, \quad x\in\R.
\]

\item
Sievennä lauseke ja piirrä kuvaaja:
\begin{align*}
&\text{a)}\ \ y=\Arccos(\sin x) \qquad\qquad\ \
 \text{b)}\ \ y=\Arctan(\tan x) \\
&\text{c)}\ \ y=\Arcsin\left(2\cos^2 x-1\right) \quad\ 
 \text{d)}\ \ y=\Arctan\frac{2\tan x}{1-\tan^2 x}
\end{align*}

\item
Näytä, että Esimerkin \ref{muuan implisiittifunktio} implisiittifunktio on esitettävissä
muodossa $y(x)=u(x)-x$, missä $u$ on jaksollinen. Mikä on perusjakso? Onko $u(x)$
parillinen/pariton? Hahmottele likimäärin funktion $y(x)$ kuvaaja. 

\item
Seuraavassa on määritelty implisiittifunktioita, mahdollisesti useampihaaraisia. Määritä näiden
haarat funktioina $x \map y(x)$ eri $\R$:n osaväleillä. Hahmottele funktiot myös graafisesti!
\begin{align*}
&\text{a)}\ \ x^2+y^2+6x=0 \qquad\ \ \
 \text{b)}\ \ x^2-y^2-4x=0 \\[1mm]
&\text{c)}\ \ xy^4+3y^2-x=0 \qquad\ \
 \text{d)}\ \ \abs{x}^{2/3}+\abs{y}^{2/3}=1 \\[2mm]
&\text{e)}\ \ x^2-4y^2+y^4=0 \qquad\quad
 \text{f)}\ \ xy^4+3x^3+6y^2-12x=0 \\
&\text{g)}\ \ x^2+\frac{\sin y}{3+\sin y}=0 \qquad\,\
 \text{h)}\ \ \arctan x + \arctan y=\frac{\pi}{4}
\end{align*}

\item
Mitkä ovat monihaaraisen funktion $\arccos(\cos x)$ arvot, kun $x=13\pi/4$\,?

\item
a) Määrittele monihaaraisen funktion $\arcsin=\{y_n\,,\ n\in\Z\}$ haarat päähaaran $y_0$
avulla. \ b) Ilmaise karteesisen koordinaatiston pisteiden ja napakulman välinen riippuvuus
$\varphi(x,y)$ funktioiden $y_n$ avulla.

\item(*) \label{H-IV-2: ratkeavuus kymmenjaolla}
Olkoon $f(x)=x^3+3x$ ja $y\in(0,\infty)$. Todista yhtälön $f(x)=y$ ratkeavuus käyttäen
kymmenjakoalgoritmia (ks.\ Luku \ref{reaaliluvut}). \kor{Vihje}: Lähde tuloksista:
$f$ on aidosti kasvava välillä $[0,\infty)$ ja $\lim_n f(n)=\infty$.

\item (*)
Tutki, millä arvoilla $x\in\R$ tai $(x,y)\in\Rkaksi$ pätee
\begin{align*}
&\text{a)}\ \ 2\Arcsin x=\Arccos(1-2x^2) \\
&\text{b)}\ \ \Arctan x+\Arctan y=\Arctan\frac{x+y}{1-xy} \hspace{4cm}
\end{align*}

\item(*)
Tutki, mitkä seuraavista funktioista tyyppiä $\,f: \N\kohti\Q$ ovat injektioita: \newline
a) \ $f(n)=n^22^{-n}\,\ $ b)\ $f(n)=n^{333}2^{-n}\,\ $ c)\ $f(n)=n^{243}3^{-n}\,\ $ 
d) \ $f(n)=n^{80}3^{-n}$

\end{enumerate}